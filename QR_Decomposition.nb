(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14040,        360]
NotebookOptionsPosition[     13101,        325]
NotebookOutlinePosition[     13480,        341]
CellTagsIndexPosition[     13437,        338]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RowCount", "[", "m_", "]"}], ":=", 
   RowBox[{"Length", "[", "m", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColumnCount", "[", "m_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RowCount", "[", "m", "]"}], "==", "0"}], ",", 
     "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
     RowBox[{"Length", "[", 
      RowBox[{"m", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.797598254505808*^9, 3.7975983663561926`*^9}, {
   3.797598491846363*^9, 3.797598522986699*^9}, {3.797598598226343*^9, 
   3.7975986008165474`*^9}, {3.7975986838064833`*^9, 
   3.7975986856963463`*^9}, {3.797599500807821*^9, 3.79759950701779*^9}, {
   3.797599632107708*^9, 3.797599636947753*^9}, {3.7976015076398087`*^9, 
   3.7976015266002717`*^9}, 3.79760196138363*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GramSchmidt", "[", "m_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rows", "=", 
      RowBox[{"RowCount", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cols", "=", 
      RowBox[{"ColumnCount", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GS", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "rows"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mt", "=", 
      RowBox[{"Transpose", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "cols"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"qiPrime", "=", 
         RowBox[{"mt", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "<", "i"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"qiPrime", "-=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"mt", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ".", 
               RowBox[{"GS", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
             RowBox[{"GS", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"++", "j"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qi", "=", 
         RowBox[{"qiPrime", "/", 
          RowBox[{"Norm", "[", "qiPrime", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"GS", "[", 
          RowBox[{"[", 
           RowBox[{"i", "++"}], "]"}], "]"}], "=", "qi"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "GS"}], 
    "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QR", "[", "m_", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "=", 
     RowBox[{"GramSchmidt", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"R", "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "Q", "]"}], ".", "m"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Q", ",", "R"}], "}"}]}], " ", "\[IndentingNewLine]", 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.7975979511357403`*^9, 3.7975979862660704`*^9}, {
   3.7975981981462183`*^9, 3.797598216716098*^9}, {3.7975982529263315`*^9, 
   3.7975982530963273`*^9}, {3.7975982855263395`*^9, 3.797598289765854*^9}, {
   3.797598391966617*^9, 3.7975983956063185`*^9}, {3.797598714586825*^9, 
   3.797598835976872*^9}, {3.7975988802368135`*^9, 3.7975989660068264`*^9}, 
   3.797599081736965*^9, {3.7975991212069626`*^9, 3.797599317027063*^9}, {
   3.7975993511673555`*^9, 3.797599367367531*^9}, {3.797599408637308*^9, 
   3.7975994255974207`*^9}, {3.797599517277969*^9, 3.797599518457854*^9}, {
   3.7975996063180213`*^9, 3.79759962121801*^9}, {3.797599667027953*^9, 
   3.797599684577574*^9}, {3.7975997881280265`*^9, 3.797599837658057*^9}, 
   3.7976005509888625`*^9, {3.7976013642899103`*^9, 3.7976014020297976`*^9}, {
   3.797602134204314*^9, 3.7976021413304777`*^9}, 3.7976022765107346`*^9, {
   3.7976024540731716`*^9, 3.797602460886162*^9}, {3.7976025284709315`*^9, 
   3.797602532441678*^9}, {3.7976029722046127`*^9, 3.7976030016504903`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "4."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "3", ",", "6"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Length", "[", "A", "]"}], "\[IndentingNewLine]", 
   RowBox[{"RowCount", "[", "A", "]"}], "\[IndentingNewLine]", 
   RowBox[{"ColumnCount", "[", "A", "]"}], "\[IndentingNewLine]", "A", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"A", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.797597997475705*^9, 3.7975980342758274`*^9}, {
   3.797598122925747*^9, 3.797598187446285*^9}, {3.7975982290659666`*^9, 
   3.7975982402562704`*^9}, {3.7975984007165947`*^9, 3.797598410447138*^9}, 
   3.7975984625663276`*^9, 3.797601420369778*^9, {3.7976018647805014`*^9, 
   3.797601896530196*^9}, {3.7976019839248934`*^9, 3.797601999457466*^9}}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.7975981280556602`*^9, 3.797598187965246*^9}, {
   3.797598234306529*^9, 3.7975982415561094`*^9}, 3.797598411654995*^9, 
   3.797598466726336*^9, {3.79759852748623*^9, 3.797598543906602*^9}, {
   3.797598575336628*^9, 3.797598604397683*^9}, 3.7975996408374977`*^9, 
   3.797599689656294*^9, 3.797601443619665*^9, {3.7976015186397996`*^9, 
   3.7976015318798294`*^9}, {3.7976018655151653`*^9, 
   3.7976019184803405`*^9}, {3.797601968696274*^9, 3.797602001430627*^9}, 
   3.7976020415806527`*^9, {3.7976023204418335`*^9, 3.7976023498410115`*^9}, 
   3.797602380432766*^9}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.7975981280556602`*^9, 3.797598187965246*^9}, {
   3.797598234306529*^9, 3.7975982415561094`*^9}, 3.797598411654995*^9, 
   3.797598466726336*^9, {3.79759852748623*^9, 3.797598543906602*^9}, {
   3.797598575336628*^9, 3.797598604397683*^9}, 3.7975996408374977`*^9, 
   3.797599689656294*^9, 3.797601443619665*^9, {3.7976015186397996`*^9, 
   3.7976015318798294`*^9}, {3.7976018655151653`*^9, 
   3.7976019184803405`*^9}, {3.797601968696274*^9, 3.797602001430627*^9}, 
   3.7976020415806527`*^9, {3.7976023204418335`*^9, 3.7976023498410115`*^9}, 
   3.7976023804507217`*^9}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.7975981280556602`*^9, 3.797598187965246*^9}, {
   3.797598234306529*^9, 3.7975982415561094`*^9}, 3.797598411654995*^9, 
   3.797598466726336*^9, {3.79759852748623*^9, 3.797598543906602*^9}, {
   3.797598575336628*^9, 3.797598604397683*^9}, 3.7975996408374977`*^9, 
   3.797599689656294*^9, 3.797601443619665*^9, {3.7976015186397996`*^9, 
   3.7976015318798294`*^9}, {3.7976018655151653`*^9, 
   3.7976019184803405`*^9}, {3.797601968696274*^9, 3.797602001430627*^9}, 
   3.7976020415806527`*^9, {3.7976023204418335`*^9, 3.7976023498410115`*^9}, 
   3.7976023804581585`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7975981280556602`*^9, 3.797598187965246*^9}, {
   3.797598234306529*^9, 3.7975982415561094`*^9}, 3.797598411654995*^9, 
   3.797598466726336*^9, {3.79759852748623*^9, 3.797598543906602*^9}, {
   3.797598575336628*^9, 3.797598604397683*^9}, 3.7975996408374977`*^9, 
   3.797599689656294*^9, 3.797601443619665*^9, {3.7976015186397996`*^9, 
   3.7976015318798294`*^9}, {3.7976018655151653`*^9, 
   3.7976019184803405`*^9}, {3.797601968696274*^9, 3.797602001430627*^9}, 
   3.7976020415806527`*^9, {3.7976023204418335`*^9, 3.7976023498410115`*^9}, 
   3.797602380464238*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "2", "4.`"},
     {"0", "0", "5"},
     {"0", "3", "6"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7975981280556602`*^9, 3.797598187965246*^9}, {
   3.797598234306529*^9, 3.7975982415561094`*^9}, 3.797598411654995*^9, 
   3.797598466726336*^9, {3.79759852748623*^9, 3.797598543906602*^9}, {
   3.797598575336628*^9, 3.797598604397683*^9}, 3.7975996408374977`*^9, 
   3.797599689656294*^9, 3.797601443619665*^9, {3.7976015186397996`*^9, 
   3.7976015318798294`*^9}, {3.7976018655151653`*^9, 
   3.7976019184803405`*^9}, {3.797601968696274*^9, 3.797602001430627*^9}, 
   3.7976020415806527`*^9, {3.7976023204418335`*^9, 3.7976023498410115`*^9}, 
   3.797602380473529*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GramSchmidt", "[", "A", "]"}]], "Input",
 CellChangeTimes->{{3.797598038375814*^9, 3.7975980743360634`*^9}, {
   3.797598428246397*^9, 3.7975984292584085`*^9}, {3.7976014313898354`*^9, 
   3.797601435219945*^9}, {3.797602426420969*^9, 3.7976024290991583`*^9}, {
   3.7976024997913227`*^9, 3.7976025008396735`*^9}, 3.7976025485582576`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.797601443668954*^9, 3.7976015380196342`*^9, 3.797602041690251*^9, {
   3.7976023205006723`*^9, 3.7976023499227495`*^9}, {3.7976024177007847`*^9, 
   3.79760243540099*^9}, 3.7976024715513787`*^9, 3.7976025016717844`*^9, {
   3.7976025423110056`*^9, 3.7976025493824277`*^9}, 3.7976030101805067`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QR", "[", "A", "]"}]], "Input",
 CellChangeTimes->{{3.7975987916866612`*^9, 3.797598794606595*^9}, {
  3.797601437379983*^9, 3.797601440289719*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.`", ",", "2.`", ",", "4.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "3.`", ",", "6.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", "5.`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7976014439898176`*^9, 3.7976015396998925`*^9, 3.7976020418701286`*^9, {
   3.79760232057071*^9, 3.7976023499951277`*^9}, 3.7976024887898483`*^9, {
   3.797602545381119*^9, 3.797602551503519*^9}, 3.7976030127207465`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QRDecomposition", "[", "A", "]"}]], "Input",
 CellChangeTimes->{{3.7976026982307568`*^9, 3.797602702763975*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", 
       RowBox[{"-", "1.`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "1.`"}], ",", "0.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.`", ",", "2.`", ",", "4.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "3.`"}], ",", 
       RowBox[{"-", "6.`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", 
       RowBox[{"-", "5.`"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7976027039331474`*^9}]
}, Open  ]]
},
WindowSize->{957, 988},
WindowMargins->{{Automatic, -1350}, {Automatic, 0}},
Magnification:>2.4 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 923, 21, 215, "Input"],
Cell[1484, 43, 3577, 80, 1091, "Input"],
Cell[CellGroupData[{
Cell[5086, 127, 1068, 23, 403, "Input"],
Cell[6157, 152, 621, 9, 103, "Output"],
Cell[6781, 163, 623, 9, 103, "Output"],
Cell[7407, 174, 623, 9, 103, "Output"],
Cell[8033, 185, 855, 17, 103, "Output"],
Cell[8891, 204, 1212, 27, 173, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10140, 236, 362, 5, 103, "Input"],
Cell[10505, 243, 588, 13, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11130, 261, 172, 3, 103, "Input"],
Cell[11305, 266, 840, 23, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12182, 294, 136, 2, 103, "Input"],
Cell[12321, 298, 764, 24, 198, "Output"]
}, Open  ]]
}
]
*)

